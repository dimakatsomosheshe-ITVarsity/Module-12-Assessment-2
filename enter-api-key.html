<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>API Key</title>
        <link rel="icon" href="img/Key-Icon.png" type="image/x-icon">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="css/style.css">
        <style>
            body {
                background: url(img/windows-11-stock-oranage-abstract-white-background-3840x2160-8992.png);
                background-repeat: no-repeat;
                background-attachment: fixed;
                background-size: 100%;
            }
            .container {
                width: 400px;
                margin: 150px auto;
            }
        </style>
    </head>
    <body>
        <div class="container glass mx-auto p-5 d-flex flex-column align-items-center mb-3">
            <span class="p-2"><i class="fa-solid fa-id-card-clip fa-6x"></i></span>
            <div class="p-2 fs-5">Please enter a valid API key.</div>
            <form class="p-2">
                <input class="" type="email" id="apiKey" name="apiKey" />
                <button class="" id="submitApiKey" style="--clr:#6eff3e"><span>Submit</span><i></i></button>
            </form>
        </div>

        <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
        <script src="js/script.js"></script>
        <script>
            let rootPath = "https://mysite.itvarsity.org/api/ContactBook/";
            document.getElementById("submitApiKey").addEventListener('click', setApiKey);

            function setApiKey(e) {
                e.preventDefault();

                apiKey = document.getElementById("apiKey").value;
                fetch(rootPath + "controller/api-key/?apiKey=" + apiKey)
                    .then(function(response) {
                        return response.text();
                    })
                    .then(function(data) {

                        if (data == "1") {
                            localStorage.setItem("apiKey", apiKey);
                            window.open("index.html", "_self");
                        } else {
                            alert(data + "Invalid API key Entered!");
                        }
                    })
            }
        </script>
    </body>
</html>